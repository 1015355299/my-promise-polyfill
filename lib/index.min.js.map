{"version":3,"sources":["index.js"],"names":["PENDING","FULFILLED","REJECTED","isObjOrFunc","result","_resolvePromise","handler","newPromise","newReject","TypeError","then","error","MyPromise","value","called","call","reason","newResolve","_handlePending","_handlers","push","_handleFulfilled","onFulfilled","_handleRejected","onRejected","_handle","state","_createHandler","that","cb","_immediateFn","handlerLen","length","i","Handler","executer","undefined","resolve","reject","_unhandledRejectionFn","prototype","constructor","bind","catch","finally","fn","setImmediate","setTimeout","err","console","warn","race","iterable","Symbol","iterator","ret","next","done","all","count","allSettled","status","module","exports"],"mappings":"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","file":"index.min.js","sourceRoot":"..\\src","sourcesContent":["var PENDING = \"pending\";\r\nvar FULFILLED = \"fulfilled\";\r\nvar REJECTED = \"rejected\";\r\n\r\nfunction isObjOrFunc(result) {\r\n  return result && (typeof result === \"object\" || typeof result === \"function\");\r\n}\r\n\r\nfunction _resolvePromise(handler, result) {\r\n  if (result === handler.newPromise) {\r\n    return handler.newReject(\r\n      new TypeError(\"A promise cannot be resolved with itself\")\r\n    );\r\n  }\r\n\r\n  if (isObjOrFunc(result)) {\r\n    try {\r\n      var then = result.then;\r\n    } catch (error) {\r\n      return handler.newReject(error);\r\n    }\r\n    if (result instanceof MyPromise) {\r\n      result.then(function (value) {\r\n        _resolvePromise(handler, value);\r\n      }, handler.newReject);\r\n      return;\r\n    } else if (typeof then === \"function\") {\r\n      var called = false;\r\n      try {\r\n        then.call(\r\n          result,\r\n          function (value) {\r\n            if (called || ((called = true), false)) return;\r\n            _resolvePromise(handler, value);\r\n          },\r\n          function (reason) {\r\n            if (called || ((called = true), false)) return;\r\n            handler.newReject(reason);\r\n          }\r\n        );\r\n      } catch (error) {\r\n        if (called) return;\r\n        handler.newReject(error);\r\n      }\r\n      return;\r\n    }\r\n  }\r\n  handler.newResolve(result);\r\n}\r\n\r\nfunction _handlePending(handler) {\r\n  this._handlers.push(handler);\r\n}\r\n\r\nfunction _handleFulfilled(handler) {\r\n  var onFulfilled = handler.onFulfilled;\r\n  if (onFulfilled === null) {\r\n    return handler.newResolve(this.result);\r\n  }\r\n  try {\r\n    var res = onFulfilled(this.result);\r\n    _resolvePromise(handler, res);\r\n  } catch (error) {\r\n    handler.newReject(error);\r\n  }\r\n}\r\n\r\nfunction _handleRejected(handler) {\r\n  var onRejected = handler.onRejected;\r\n  if (onRejected === null) {\r\n    return handler.newReject(this.result);\r\n  }\r\n  try {\r\n    var res = onRejected(this.result);\r\n    _resolvePromise(handler, res);\r\n  } catch (error) {\r\n    handler.newReject(error);\r\n  }\r\n}\r\n\r\nfunction _handle(handler) {\r\n  if (this.state === FULFILLED) {\r\n    _handleFulfilled.call(this, handler);\r\n  } else if (this.state === REJECTED) {\r\n    _handleRejected.call(this, handler);\r\n  }\r\n}\r\n\r\nfunction _createHandler(that, state, cb) {\r\n  return function (result) {\r\n    MyPromise._immediateFn(function () {\r\n      if (that.state === PENDING) {\r\n        that.state = state;\r\n        that.result = result;\r\n        var handlerLen = that._handlers.length;\r\n        if (handlerLen === 0 && cb) {\r\n          cb(result);\r\n        } else {\r\n          for (var i = 0; i < that._handlers.length; i++) {\r\n            var handler = that._handlers[i];\r\n            _handle.call(that, handler);\r\n          }\r\n        }\r\n        delete that._handlers;\r\n      }\r\n    });\r\n  };\r\n}\r\n\r\nfunction Handler(onFulfilled, onRejected, newResolve, newReject, newPromise) {\r\n  this.onFulfilled = typeof onFulfilled === \"function\" ? onFulfilled : null;\r\n  this.onRejected = typeof onRejected === \"function\" ? onRejected : null;\r\n  this.newResolve = newResolve;\r\n  this.newReject = newReject;\r\n  this.newPromise = newPromise;\r\n}\r\n\r\nfunction MyPromise(executer) {\r\n  if (!(this instanceof MyPromise)) {\r\n    throw new TypeError(\"Promises must be constructed via new\");\r\n  }\r\n\r\n  if (typeof executer !== \"function\") {\r\n    throw new TypeError(\"not a function\");\r\n  }\r\n\r\n  this.state = PENDING;\r\n  this.result = undefined;\r\n  this._handlers = [];\r\n\r\n  var resolve = _createHandler(this, FULFILLED);\r\n  var reject = _createHandler(this, REJECTED, function (reason) {\r\n    MyPromise._unhandledRejectionFn(reason);\r\n  });\r\n\r\n  try {\r\n    executer(resolve, reject);\r\n  } catch (error) {\r\n    reject(error);\r\n  }\r\n}\r\n\r\nMyPromise.prototype.then = function (onFulfilled, onRejected) {\r\n  var handler;\r\n  var newPromise = new this.constructor(function (resolve, reject) {\r\n    handler = new Handler(onFulfilled, onRejected, resolve, reject);\r\n  });\r\n  handler.newPromise = newPromise;\r\n  if (this.state === PENDING) {\r\n    _handlePending.call(this, handler);\r\n  } else if (this.state === FULFILLED) {\r\n    MyPromise._immediateFn(_handleFulfilled.bind(this, handler));\r\n  } else if (this.state === REJECTED) {\r\n    MyPromise._immediateFn(_handleRejected.bind(this, handler));\r\n  }\r\n  return newPromise;\r\n};\r\n\r\nMyPromise.prototype.catch = function (onRejected) {\r\n  return this.then(null, onRejected);\r\n};\r\n\r\nMyPromise.prototype.finally = function (cb) {\r\n  return this.then(\r\n    function (value) {\r\n      return MyPromise.resolve(cb()).then(function () {\r\n        return value;\r\n      });\r\n    },\r\n    function (reason) {\r\n      return MyPromise.resolve(cb()).then(function () {\r\n        return MyPromise.reject(reason);\r\n      });\r\n    }\r\n  );\r\n};\r\n\r\nMyPromise._immediateFn = function (fn) {\r\n  if (typeof setImmediate === \"function\") {\r\n    setImmediate(fn);\r\n  } else {\r\n    setTimeout(fn, 0);\r\n  }\r\n};\r\n\r\nMyPromise._unhandledRejectionFn = function (err) {\r\n  if (typeof console !== \"undefined\" && console) {\r\n    console.warn(\"Possible Unhandled MyPromise Rejection:\", err);\r\n  }\r\n};\r\n\r\nMyPromise.resolve = function (value) {\r\n  if (value instanceof MyPromise) {\r\n    return value;\r\n  }\r\n  return new MyPromise(function (resolve) {\r\n    resolve(value);\r\n  });\r\n};\r\n\r\nMyPromise.reject = function (reason) {\r\n  return new MyPromise(function (resolve, reject) {\r\n    reject(reason);\r\n  });\r\n};\r\n\r\nMyPromise.race = function (iterable) {\r\n  return new MyPromise(function (resolve, reject) {\r\n    if (typeof iterable[Symbol.iterator] !== \"function\") {\r\n      throw new TypeError(\"MyPromise.race accepts an iterable\");\r\n    }\r\n    var iterator = iterable[Symbol.iterator]();\r\n    for (var ret; (ret = iterator.next()), ret.done === false; ) {\r\n      MyPromise.resolve(ret.value).then(resolve, reject);\r\n    }\r\n  });\r\n};\r\n\r\nMyPromise.all = function (iterable) {\r\n  return new MyPromise(function (resolve, reject) {\r\n    if (typeof iterable[Symbol.iterator] !== \"function\") {\r\n      throw new TypeError(\"MyPromise.all accepts an iterable\");\r\n    }\r\n    var iterator = iterable[Symbol.iterator]();\r\n    var count = 0,\r\n      result = [];\r\n    for (var i = 0, ret; (ret = iterator.next()), ret.done === false; i++) {\r\n      (function (i) {\r\n        count++;\r\n        MyPromise.resolve(ret.value).then(function (value) {\r\n          result[i] = value;\r\n          if (--count === 0) resolve(result);\r\n        }, reject);\r\n      })(i);\r\n    }\r\n    if (i === 0 && ret.done === true) resolve(result);\r\n  });\r\n};\r\n\r\nMyPromise.allSettled = function (iterable) {\r\n  return new MyPromise(function (resolve, reject) {\r\n    if (typeof iterable[Symbol.iterator] !== \"function\") {\r\n      throw new TypeError(\"MyPromise.allSettled accepts an iterable\");\r\n    }\r\n    var iterator = iterable[Symbol.iterator]();\r\n    var count = 0,\r\n      result = [];\r\n    for (var i = 0, ret; (ret = iterator.next()), ret.done === false; i++) {\r\n      (function (i) {\r\n        count++;\r\n        MyPromise.resolve(ret.value).then(\r\n          function (value) {\r\n            result[i] = { status: FULFILLED, value: value };\r\n            if (--count === 0) resolve(result);\r\n          },\r\n          function (reason) {\r\n            result[i] = { status: REJECTED, reason: reason };\r\n            if (--count === 0) resolve(result);\r\n          }\r\n        );\r\n      })(i);\r\n    }\r\n    if (i === 0 && ret.done === true) resolve(result);\r\n  });\r\n};\r\n\r\nmodule.exports = MyPromise;\r\n"]}